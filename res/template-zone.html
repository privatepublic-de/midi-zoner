<div class="zone" id="zone${index}">
  <div class="channels">
    <div
      class="ch state enabled"
      data-action="${index}:enabled"
      title="Enable zone ${zoneMuteKeyboardHint}"
    >
      <span class="material-icons isenabled"> check </span>
      <span class="material-icons isdisabled"> close </span>
    </div>
    <div
      class="ch solo"
      data-action="${index}:solo"
      title="Solo Zone\n(Double click for this zone only)"
    >
      S
    </div>
    <div
      class="ch showseq"
      data-action="${index}:toggle_seq"
      title="Enable step sequencer"
    >
      <i class="material-icons">view_comfy</i>
      <progress max="100" value="0" class="seqprogress"></progress>
    </div>
    <div
      class="ch showarp arp_enabled"
      data-action="${index}:arp_enabled"
      title="Enable arpeggiator"
    >
      Arp
    </div>
    <div
      class="ch showccs"
      data-action="${index}:toggle_show_cc"
      title="Show CC controllers"
    >
      CC
    </div>
    <div class="outselection">
      <select
        class="outport"
        data-change="${index}:outport"
        title="Select output port or preset"
      >
        <option value="*"></option>
      </select>
      <input
        type="text"
        class="output-config-name"
        placeholder="(untitled)"
        onKeyUp="event.stopPropagation();"
        title="Edit output preset name"
        data-change="${index}:output_config_name"
      />
    </div>
    <div
      class="sendClock"
      data-action="${index}:sendClock"
      title="Transmit clock to this device"
    >
      <i class="material-icons sel">watch_later</i
      ><i class="material-icons unsel">query_builder</i>
    </div>
    ${channelselector}
    <div class="zonetools">
      <div
        class="randzonecolor rtool"
        data-action="${index}:changeColor"
        title="Change color"
      >
        <label><i class="material-icons">palette</i></label>
      </div>
      <div class="dragzone rtool" title="Drag zone">
        <i class="material-icons">swap_vert</i>
      </div>
      <div
        class="delzone rtool"
        data-action="${index}:delete"
        title="Remove zone"
      >
        <i class="material-icons">close</i>
      </div>
    </div>
  </div>
  <div class="seq" data-action="${index}:select_step:-1">
    <div class="grid">
      <div class="step-container">${sequencerGrid}</div>
      <div class="seq-layer-indicator" title="Active layer">
        <span>A</span>
      </div>
    </div>
    <div class="seqtools">
      <div class="label">Steps</div>
      <div class="val">
        <input
          title="Number of steps in sequence"
          class="seq_steps"
          type="number"
          min="1"
          max="${seqMaxSteps}"
          value="16"
          data-change="${index}:seq_steps"
        />
      </div>
      <div class="drop-down" title="Step resolution">
        <select class="seq_division" data-change="${index}:seq_division">
          ${noteLengthOptions}
        </select>
      </div>
      <div
        class="action"
        title="Move whole sequence 1 step left"
        data-action="${index}:seq_move:-1"
      >
        <i class="material-icons">chevron_left</i>
      </div>
      <div
        class="action"
        title="Move whole sequence 1 step right"
        data-action="${index}:seq_move:1"
      >
        <i class="material-icons">chevron_right</i>
      </div>
      <div class="drop-down" title="Transpose whole sequence">
        <select class="seq_division" data-change="${index}:seq_transpose">
          <option>Transp</option>
          <optgroup>
            <option value="-12">-12</option>
            <option value="12">+12</option>
          </optgroup>
          <optgroup>
            <option value="-11">-11</option>
            <option value="-10">-10</option>
            <option value="-9">-9</option>
            <option value="-8">-8</option>
            <option value="-7">-7</option>
            <option value="-6">-6</option>
            <option value="-5">-5</option>
            <option value="-4">-4</option>
            <option value="-3">-3</option>
            <option value="-2">-2</option>
            <option value="-1">-1</option>
          </optgroup>
          <optgroup>
            <option value="1">+1</option>
            <option value="2">+2</option>
            <option value="3">+3</option>
            <option value="4">+4</option>
            <option value="5">+5</option>
            <option value="6">+6</option>
            <option value="7">+7</option>
            <option value="8">+8</option>
            <option value="9">+9</option>
            <option value="10">+10</option>
            <option value="11">+11</option>
          </optgroup>
        </select>
      </div>
      <div class="drop-down" title="Adjust whole sequence">
        <select data-change="${index}:seq_adjust">
          <option>Adjust steps</option>
          <option value="double">Double</option>
          <option value="halftime">Double time</option>
          <option value="thirdtime">Triple time</option>
        </select>
      </div>
      <div class="action" title="Copy sequence" data-action="${index}:seq_copy">
        <i class="material-icons">content_copy</i>
      </div>
      <div
        class="action"
        title="Paste sequence"
        data-action="${index}:seq_paste"
      >
        <i class="material-icons">content_paste</i>
      </div>
      <div
        class="action"
        title="Clear complete sequence"
        data-action="${index}:seq_clear_all"
      >
        <i class="material-icons">clear</i>
      </div>
      <div
        class="action seq_record_live"
        title="Live recording while sequence is playing"
        data-action="${index}:seq_record_live"
      >
        <i class="material-icons">piano</i>
      </div>
    </div>
    <div class="step-info popup" data-action="${index}:ignore">
      <div class="step-controls">
        <div class="stepmarker listen-indicator"></div>
        <div
          class="step-notes"
          data-dragvalue="${index}:seq_step_velocity"
          data-draghint="Velocity: "
          title="Drag with mouse to change velocity values"
        ></div>
        <div
          class="check seq-step-add-notes"
          data-action="${index}:seq_step_add_notes"
          title="New notes are added (no overwrite)"
        >
          ${checkboxIcons}Add
        </div>
        <div
          class="check seq-step-advance"
          data-action="${index}:seq_step_advance"
          title="Advance step after note input"
        >
          ${checkboxIcons}Advance
        </div>
        <div class="step-info-close" data-action="${index}:select_step:-1">
          <i class="material-icons">close</i>
        </div>
      </div>
      <div class="step-controls">
        <div class="label">Length</div>
        <input
          class="seq_step_length"
          type="number"
          min="1"
          max="${seqMaxSteps}"
          value="1"
          data-change="${index}:seq_step_length"
        />
        <div class="percent-holder">
          <input
            class="percent seq_gatelength"
            type="range"
            min="0"
            max="100"
            data-change="${index}:seq_gatelength"
            id="seq_gatelength${index}"
            title="Step gate length"
          />
          <output for="seq_gatelength${index}">(unset)</output>
        </div>
        <div class="label">Condition</div>
        <div class="drop-down" title="Select step play condition">
          <select
            class="seq_step_condition"
            data-change="${index}:seq_step_condition"
          >
            <option>always</option>
            <option title="Previous was played">Prev.</option>
            <option title="Previous was not played">Not prev.</option>
            <option title="Only in first cycle">1st</option>
            <option title="Not in first cycle">Not 1st</option>
            ${cycleConditions}
          </select>
        </div>
        <div class="label">Chance</div>
        <div class="percent-holder">
          <input
            class="percent seq_step_probability"
            type="range"
            min="0"
            max="100"
            data-change="${index}:seq_step_probability"
            id="seq_step_probability${index}"
            title="Chance step is triggered"
          />
          <output for="seq_step_probability${index}">(unset)</output>
        </div>
      </div>
      <div class="step-controls">
        <div
          class="action"
          title="Move step left (if free space)"
          data-action="${index}:seq_step_move:-1"
        >
          <i class="material-icons">chevron_left</i>
        </div>
        <div
          class="action"
          title="Move step right (if free space)"
          data-action="${index}:seq_step_move:1"
        >
          <i class="material-icons">chevron_right</i>
        </div>
        <div
          class="action"
          title="Copy step"
          data-action="${index}:seq_copy_step"
        >
          <i class="material-icons">content_copy</i>
        </div>
        <div
          class="action"
          title="Paste step"
          data-action="${index}:seq_paste_step"
        >
          <i class="material-icons">content_paste</i>
        </div>
        <div
          class="action"
          title="Clear step"
          data-action="${index}:seq_clear_step"
        >
          <i class="material-icons">clear</i>
        </div>
        <div
          class="drop-down"
          title="Apply step properties to all active steps in sequence"
        >
          <select class="" data-change="${index}:seq_step_apply_to_all">
            <option>Apply to allâ€¦</option>
            <option>Step Length</option>
            <option>Gate Length</option>
            <option>Condition</option>
            <option>Chance</option>
          </select>
        </div>
      </div>
    </div>
  </div>
  <div class="">
    <div class="arp-settings">
      <div class="label">Arpeggiator</div>
      <div class="drop-down">
        <select
          class="arp_direction"
          data-change="${index}:arp_direction"
          title="Arp play direction"
        >
          <option>Up</option>
          <option>Down</option>
          <option>Up / Down</option>
          <option>Random</option>
          <option>Order</option>
        </select>
      </div>
      <div class="drop-down">
        <select class="arp_division" data-change="${index}:arp_division">
          ${noteLengthOptions}
        </select>
      </div>
      <div class="label">Octaves</div>
      <div class="drop-down">
        <select class="arp_octaves" data-change="${index}:arp_octaves">
          <option>1</option>
          <option>2</option>
          <option>3</option>
          <option>4</option>
        </select>
      </div>
      <div class="check arp_repeat" data-action="${index}:arp_repeat">
        ${checkboxIcons}Repeat
      </div>
      <div
        class="check arp_hold"
        data-action="${index}:arp_hold"
        title="Hold notes after key release"
      >
        ${checkboxIcons}Hold
        <span
          class="arp_transpose innertoggle"
          title="Use keyboard to transpose held arpeggio"
          data-action="${index}:arp_transpose"
        >
          t
        </span>
      </div>
    </div>
    <div class="arp-settings">
      <div class="label">Len</div>
      <div class="percent-holder">
        <input
          type="range"
          class="percent arp_gatelength"
          data-change="${index}:arp_gatelength"
          id="arp_gatelength${index}"
          min="0"
          max="100"
        />
        <output for="arp_gatelength${index}">---</output>
      </div>
      <div class="label">Chance</div>
      <div
        class="percent-holder"
        title="Chance arpeggiator notes are triggered"
      >
        <input
          type="range"
          class="percent arp_probability"
          data-change="${index}:arp_probability"
          id="arp_probability${index}"
          min="0"
          max="100"
        />
        <output for="arp_probability${index}">---</output>
      </div>
      <div class="label">Pattern</div>
      <div
        class="pattern"
        data-action="${index}:arp_pattern"
        title="Arpeggiator pattern"
      >
        <canvas
          id="canvasPattern${index}"
          style="width: 100px; height: 16px"
        ></canvas>
      </div>
      <div
        class="patgen action"
        title="Create or shift pattern"
        data-action="${index}:showeuclid"
      >
        <i class="material-icons">edit</i>
      </div>
      <div class="euclid hideonleave popup">
        <p>Create euclidian pattern</p>
        <div>
          <input
            id="euchits${index}"
            type="number"
            min="1"
            max="32"
            value="8"
            size="3"
            title="Steps"
          />
          <div>in</div>
          <input
            type="number"
            id="euclen${index}"
            min="1"
            max="32"
            value="8"
            size="3"
            title="Length"
          />
          <div class="action" data-action="${index}:euclid">OK</div>
        </div>
        <div>
          <span class="action" data-action="${index}:pattern_shift:-1"
            >&lt;</span
          >
          <span>Shift pattern</span>
          <span class="action" data-action="${index}:pattern_shift:1"
            >&gt;</span
          >
        </div>
      </div>
    </div>
  </div>

  <div class="ccpots">
    <div class="ccpotttools">
      <div class="action-light">
        <i
          class="material-icons edit-cc-button"
          title="Edit controls"
          data-action="${index}:cc_edit"
          >edit</i
        >
      </div>
      <div class="action-light">
        <i
          class="material-icons"
          data-action="${index}:send_all_cc"
          title="Send all values"
          >double_arrow</i
        >
      </div>
    </div>
    <div class="cc-editor popup">
      <div class="flex-row">
        <label>Name</label>
        <input
          class="cclabel"
          type="text"
          style="width: 8em"
          data-change="${index}:cc_label"
        />
        <label>CC#</label>
        <input
          type="number"
          class="cc-out"
          min="0"
          max="127"
          data-change="${index}:cc_number"
        />
        <label>Type</label>
        <select class="cc_change_type" data-change="${index}:cc_change_type">
          <option value="0">Rotary</option>
          <option value="1">Rotary (+/-)</option>
          <option value="3">Buttons</option>
          <option value="2">Spacer</option>
        </select>
        <div style="flex-grow: 1"></div>
        <div class="action" data-action="${index}:cc_left">
          <span class="material-icons" title="Move left">arrow_back</span>
        </div>
        <div class="action warn" data-action="${index}:cc_remove">
          <span class="material-icons" title="Remove">close</span>
        </div>
        <div class="action" data-action="${index}:cc_add">
          <span class="material-icons" title="Add new">add</span>
        </div>
        <div class="action" data-action="${index}:cc_right">
          <span class="material-icons" title="Move right">arrow_forward</span>
        </div>
      </div>
      <div class="flex-row values">
        <label>Map to input CC#</label>
        <input
          type="number"
          class="cc-in"
          min="0"
          max="127"
          data-change="${index}:cc_number_in"
        />
        <label class="minmax">Value min</label>
        <input
          type="number"
          class="cc-min minmax"
          min="0"
          max="127"
          data-change="${index}:cc_min"
        />
        <label class="minmax">Max</label>
        <input
          type="number"
          class="cc-max minmax"
          min="0"
          max="127"
          data-change="${index}:cc_max"
        />
      </div>
      <div class="cc_buttoncontainer">
        <div class="flex-row cc_buttons">
          <label>Button 1</label>
          <input
            type="text"
            placeholder="(Label)"
            data-change="${index}:cc_button_label:0"
          />
          <input
            type="number"
            min="0"
            max="127"
            placeholder="(Val)"
            data-change="${index}:cc_button_value:0"
          />
        </div>
        <div class="flex-row cc_buttons">
          <label>Button 2</label>
          <input type="text" data-change="${index}:cc_button_label:1" />
          <input
            type="number"
            min="0"
            max="127"
            data-change="${index}:cc_button_value:1"
          />
        </div>
        <div class="flex-row cc_buttons">
          <label>Button 3</label>
          <input type="text" data-change="${index}:cc_button_label:2" />
          <input
            type="number"
            min="0"
            max="127"
            data-change="${index}:cc_button_value:2"
          />
        </div>
        <div class="flex-row cc_buttons">
          <label>Button 4</label>
          <input type="text" data-change="${index}:cc_button_label:3" />
          <input
            type="number"
            min="0"
            max="127"
            data-change="${index}:cc_button_value:3"
          />
        </div>
      </div>
    </div>
  </div>
  <div class="rangeholder">
    <div
      class="range"
      data-hover="${index}:range"
      data-action="${index}:range"
      title="Select start and end note
(hold 'shift' for octave note stepping)"
    >
      ${octavemarkers}
      <span class="rangeborder"></span>
      <span class="join"></span>
      <span class="current"></span>
      <span class="marker low">C-1</span>
      <span class="marker high">G9</span>
      <canvas id="canvas${index}" width="100%" height="20"></canvas>
    </div>
  </div>
  <div class="settings">
    <div class="val label">Oct</div>
    <div class="val octaves" title="Transpose octave">
      <a class="octselect" data-action="${index}:octave:-3"></a>
      <a class="octselect" data-action="${index}:octave:-2"></a>
      <a class="octselect" data-action="${index}:octave:-1"></a>
      <a
        class="octselect octcenter selected"
        data-action="${index}:octave:0"
      ></a>
      <a class="octselect" data-action="${index}:octave:1"></a>
      <a class="octselect" data-action="${index}:octave:2"></a>
      <a class="octselect" data-action="${index}:octave:3"></a>
    </div>
    <div class="action toggle_filters" data-action="${index}:toggle_filters">
      Filters <span class="material-icons">expand_more</span>
    </div>
    <div class="popupsettings popup hideonleave">
      <div
        class="check pitchbend"
        data-action="${index}:pitchbend"
        title="Transmit pitch bend messages"
      >
        ${checkboxIcons}Pitch Bend
      </div>
      <div
        class="check mod"
        data-action="${index}:mod"
        title="Transmit mod wheel messages (CC 1)"
      >
        ${checkboxIcons}Wheel
      </div>
      <div
        class="check sustain"
        data-action="${index}:sustain"
        title="Transmit sustain pedal messages (CC 64)"
      >
        ${checkboxIcons}Sustain
        <span class="innertoggle sustain_on" data-action="${index}:sustain_on"
          >ON</span
        >
      </div>
      <div
        class="check cc"
        data-action="${index}:cc"
        title="Transmit control change messages"
      >
        ${checkboxIcons}CC
      </div>
      <div
        class="check at2mod"
        data-action="${index}:at2mod"
        title="Convert channel pressure (aftertouch) to mod (CC 1)"
      >
        ${checkboxIcons}Aftertouch &gt; MW
      </div>
      <div style="width: 100%"></div>
      <div
        class="check fixedvel"
        data-action="${index}:fixedvel"
        title="Use fixed velocity"
      >
        ${checkboxIcons}Fixed Vel
        <input
          type="number"
          id="fixedvel${index}"
          onclick="event.stopPropagation();"
          data-change="${index}:fixedvel_value"
          value="127"
          min="1"
          max="127"
        />
      </div>
      <div class="label">Vel%</div>
      <div class="percent-holder">
        <input
          type="range"
          class="percent velocity_scaling"
          data-change="${index}:velocity_scaling"
          id="velocity_scaling${index}"
          min="0"
          max="200"
        />
        <output for="velocity_scaling${index}">---</output>
      </div>
      <div
        class="check programchange"
        data-action="${index}:programchange"
        title="Transmit program change messages"
      >
        ${checkboxIcons}Program
        <input
          title="Send a program change message"
          class="programnumber"
          type="number"
          value=""
          min="1"
          max="128"
          data-change="${index}:changeprogram"
          onclick="event.stopPropagation();"
        />
      </div>
    </div>
  </div>
  <div class="zonenumber">${zoneNumber}</div>
</div>
